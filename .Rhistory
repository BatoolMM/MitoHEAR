library(rmarkdown)
package_version(rmarkdown)
package_version("rmarkdown")
package_version("rmarkdown")
packageVersion("rmarkdown")
install.packages("rmarkdown")
install.packages("rmarkdown")
library(rmarkdown)
packageVersion("rmarkdown")
install.packages("Rd2roxygen")
Rd2roxygen::Rd2roxygen('/Users/gabriele.lubatti/JossNuovo')
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:47 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
##------ Tue Jan 25 19:12:48 2022 ------##
Rd2roxygen::Rd2roxygen('/Users/gabriele.lubatti/JossNuovo')
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:06 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
##------ Tue Jan 25 19:14:07 2022 ------##
usethis::use_testthat()
devtools::test()
devtools::check()
getwd()
setwd("/Users/gabriele.lubatti/JossNuovo")
library(MitoHEAR)
devtools::document()
devtools::check(vignettes = FALSE)
?get_heteroplasmy
library(MitoHEAR)
load(system.file("extdata", "after_qc.Rda", package = "MitoHEAR"))
cell_names=as.vector(after_qc$new_name)
load(system.file("extdata", "output_SNP_mt.Rda", package = "MitoHEAR"))
matrix_allele_counts=output_SNP_mt[[1]]
name_position_allele=output_SNP_mt[[2]]
name_position=output_SNP_mt[[3]]
matrix_allele_counts=output_SNP_mt[[1]]
name_position_allele=output_SNP_mt[[2]]
name_position=output_SNP_mt[[3]]
row.names(after_qc)=after_qc$new_name
cells_fmk_epi=after_qc[(after_qc$condition=="Cell competition OFF")&(after_qc$cluster==1|after_qc$cluster==3|after_qc$cluster==4),"new_name"]
after_qc_fmk_epi=after_qc[cells_fmk_epi,]
my.clusters=after_qc_fmk_epi$cluster
epiblast_ci=get_heteroplasmy(matrix_allele_counts[cells_fmk_epi,],name_position_allele,name_position,number_reads=50,number_positions=2000,filtering = 2,my.clusters)
sum_matrix=epiblast_ci[[1]]
sum_matrix_qc=epiblast_ci[[2]]
heteroplasmy_matrix_ci=epiblast_ci[[3]]
allele_matrix_ci=epiblast_ci[[4]]
cluster_ci=as.character(after_qc[row.names(heteroplasmy_matrix_ci),]$cluster)
cluster_ci[cluster_ci=="1"]="Winner Epiblast"
cluster_ci[cluster_ci=="3"]="Intermediate"
cluster_ci[cluster_ci=="4"]="Loser Epiblast"
condition_ci=as.character(after_qc[row.names(heteroplasmy_matrix_ci),]$condition)
index_ci=epiblast_ci[[5]]
plot_cells_coverage(sum_matrix_qc,row.names(sum_matrix_qc),cluster_ci,interactive=FALSE)
plot_base_coverage(sum_matrix,sum_matrix_qc,row.names(sum_matrix_qc),interactive=FALSE,text_size=10)
plot_base_coverage(sum_matrix,sum_matrix_qc,row.names(sum_matrix_qc)[1],interactive=FALSE,text_size=10)
name_position_allele_qc=name_position_allele[name_position%in%colnames(sum_matrix_qc)]
name_position_qc=name_position[name_position%in%colnames(sum_matrix_qc)]
relevant_bases=filter_bases(heteroplasmy_matrix_ci,min_heteroplasmy=0.01,min_cells=10,index_ci)
p_value_wilcox_test=get_wilcox_test(heteroplasmy_matrix_ci[,relevant_bases],cluster_ci,"Winner Epiblast","Loser Epiblast" ,index_ci)
p_value_wilcox_test_sort=sort(p_value_wilcox_test,decreasing = F)
q=list()
for ( i in 1:length(p_value_wilcox_test_sort[1:2])){
p=plot_heteroplasmy(names(p_value_wilcox_test_sort)[i],heteroplasmy_matrix_ci,cluster_ci,index_ci)+ggplot2::ggtitle(paste(names(p_value_wilcox_test_sort)[i],round(p_value_wilcox_test_sort[i],4),sep="-"))
q=list(q,p)
}
q
q=list()
for ( i in names(p_value_wilcox_test_sort)[1:2]){
p=plot_allele_frequency(i,heteroplasmy_matrix_ci,allele_matrix_ci,cluster_ci,name_position_qc,name_position_allele_qc,5,index_ci)
q=list(q,p)
}
q
time=after_qc[row.names(heteroplasmy_matrix_ci),]$pseudo_time
dpt_analysis=dpt_test(heteroplasmy_matrix_ci[,relevant_bases],time,index_ci,method="GAM")
dpt_analysis_result_final=dpt_analysis[dpt_analysis$FDR_value<0.001,]
q=list()
for ( i in dpt_analysis$Position[1:2]){
p=plot_dpt(i,heteroplasmy_matrix_ci,cluster_ci,time,dpt_analysis,index_ci)
q=list(q,p)
}
q
bases_example=c("326_MT","327_MT","303_MT")
plot_correlation_bases(bases_example,index_ci,heteroplasmy_matrix_ci)
plot_spider_chart("326_MT",cluster_ci,heteroplasmy_matrix_ci,index_ci)
plot_spider_chart("327_MT",cluster_ci,heteroplasmy_matrix_ci,index_ci)
plot_spider_chart("303_MT",cluster_ci,heteroplasmy_matrix_ci,index_ci)
load(system.file("extdata", "coordinate_dm.Rda", package = "MitoHEAR"))
plot_coordinate_heteroplasmy(coordinate_dm,heteroplasmy_matrix_ci,index_ci,"327_MT")
dim(coordinate_dm)
dim(heteroplasmy_matrix_ci)
coordinate_dm=coordinate_dm[row.names(heteroplasmy_matrix_ci),]
plot_coordinate_heteroplasmy(coordinate_dm,heteroplasmy_matrix_ci,index_ci,"327_MT")
length(index_ci)
dim(heteroplasmy_matrix_ci)
index_ci["327_MT"]
index_ci["326_MT"]
dim(sum_matrix)
all(row.names(sum_matrix)%in%row.names(coordinate_dm))
sum(row.names(sum_matrix)%in%row.names(coordinate_dm))
load(system.file("extdata", "coordinate_dm.Rda", package = "MitoHEAR"))
coordinate_dm=coordinate_dm[row.names(heteroplasmy_matrix_ci),]
all(row.names(sum_matrix)%in%row.names(coordinate_dm))
all(row.names(heteroplasmy_matrix_ci)%in%row.names(coordinate_dm))
all(row.names(heteroplasmy_matrix_ci)==row.names(coordinate_dm))
head(coordinate_dm)
index_ci[["327_MT"]]
coordinate_dm[index_ci[["327_MT"]],]
library(MitoHEAR)
library(MitoHEAR)
plot_coordinate_heteroplasmy(coordinate_dm,heteroplasmy_matrix_ci,index_ci,"327_MT")
?get_heteroplasmy
library(MitoHEAR)
plot_coordinate_heteroplasmy(coordinate_dm,heteroplasmy_matrix_ci,index_ci,"327_MT")
plot_coordinate_heteroplasmy
load(system.file("extdata", "coordinate_dm.Rda", package = "MitoHEAR"))
coordinate_dm=coordinate_dm[row.names(heteroplasmy_matrix_ci),]
plot_coordinate_heteroplasmy(coordinate_dm,heteroplasmy_matrix_ci,index_ci,"327_MT")
load(system.file("extdata", "coordinate_dm.Rda", package = "MitoHEAR"))
coordinate_dm=coordinate_dm[row.names(sum_matrix),]
load(system.file("extdata", "coordinate_dm.Rda", package = "MitoHEAR"))
coordinate_dm=coordinate_dm[row.names(sum_matrix),]
coordinate_dm=coordinate_dm[row.names(heteroplasmy_matrix_ci),]
plot_coordinate_heteroplasmy(coordinate_dm,heteroplasmy_matrix_ci,index_ci,"327_MT")
library(MitoHEAR)
library(MitoHEAR)
load(system.file("extdata", "coordinate_dm.Rda", package = "MitoHEAR"))
coordinate_dm=coordinate_dm[row.names(sum_matrix),]
coordinate_dm=coordinate_dm[row.names(heteroplasmy_matrix_ci),]
plot_coordinate_heteroplasmy(coordinate_dm,heteroplasmy_matrix_ci,index_ci,"327_MT")
load(system.file("extdata", "coordinate_dm.Rda", package = "MitoHEAR"))
coordinate_dm=coordinate_dm[row.names(heteroplasmy_matrix_ci),]
plot_coordinate_heteroplasmy(coordinate_dm,heteroplasmy_matrix_ci,index_ci,"327_MT")
devtools::check(vignettes = TRUE)
vignette(package="MitoHEAR")
vignette()
?vignette
?vignette(package="MitoHEAR")
vignette(package="MitoHEAR")
vignette("MitoHEAR")
vignette("MitoHEAR.Rmd")
vignette(MitoHEAR)
vignette(package="MitoHEAR")
browseVignettes("MitoHEAR")
devtools::install(build_vignettes = TRUE)
library(MitoHEAR)
vignette("MitoHEAR")
devtools::document()
devtools::document()
devtools::document()
devtools::check(vignettes = FALSE)
devtools::document()
?devtools::install_github
vignette(MitoHEAR)
vignette(MitoHEAR"")
vignette("MitoHEAR")
?devtools::install
devtools::install(build_vignettes = TRUE)
vignette("MitoHEAR")
?vignette
utils::vignette("MitoHEAR")
?get_raw_counts_allele
