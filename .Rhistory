setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
data_genes=read.table(vector_rpkm[1],header = T,sep="\t")
genes_name=data_genes[,1]
deng_rpkm_oocyte=matrix(unlist(name_file), byrow=FALSE, nrow=length(name_file[[1]]))
deng_rpkm_oocyte=log(deng_rpkm_oocyte+1)
row.names(deng_rpkm_oocyte)=genes_name
colnames(deng_rpkm_oocyte)=vector_rpkm
colnames(deng_rpkm_oocyte)[grep("oo",vector_rpkm)]="oocyte"
#genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3")
genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3","Nlrp5","Myod1")
deng_all=cbind(deng_rpkm[genes_to_plot,],deng_rpkm_oocyte[genes_to_plot,])
deng_rpkm_plot=as.matrix(deng_all)
stages_deng=colnames(deng_rpkm_plot)
mean_oocyte=apply(deng_rpkm_plot[,stages_deng=="oocyte"],1,mean)
mean_zygote=apply(deng_rpkm_plot[,stages_deng=="zygote"],1,mean)
mean_early2cell=apply(deng_rpkm_plot[,stages_deng=="early2cell"],1,mean)
deng_rpkm_plot_mean=rbind(mean_oocyte,mean_zygote,mean_early2cell)
deng_rpkm_plot_mean=t(deng_rpkm_plot_mean)
library(gplots)
heatmap.2(deng_rpkm_plot_mean, scale = "none", col = bluered(100),
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F)
#oocyte, zygote and early 2-cell
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng")
load("raw_counts_deng.Rda")
load("stages_deng.Rda")
load("stages_deng_update.Rda")
raw_counts_deng=raw_counts_deng[,(stages_deng_update=="Early_2_cell")|(stages_deng_update=="Zygote")]
stages_deng_update=stages_deng_update[(stages_deng_update=="Early_2_cell")|(stages_deng_update=="Zygote")]
seurat_genes=Normalization_seurat_here(raw_counts_deng,stages_deng_update)
#for folder in *.gz
#do
#gunzip ${folder}
#done
vector_rpkm=list.files("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
name_file=rep(0,length(vector_rpkm))
for (i in 1:length(vector_rpkm)){
name_file[i]=substr(vector_rpkm[i],1,10)
name_file[i]=read.table(vector_rpkm[i],header = F)[3]
}
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
data_genes=read.table(vector_rpkm[1],header = F)
genes_name=data_genes[,1]
deng_rpkm=matrix(unlist(name_file), byrow=FALSE, nrow=length(name_file[[1]]))
deng_rpkm=log(deng_rpkm+1)
row.names(deng_rpkm)=genes_name
colnames(deng_rpkm)=vector_rpkm
colnames(deng_rpkm)[grep("zy",vector_rpkm)]="zygote"
colnames(deng_rpkm)[grep("early2cell",vector_rpkm)]="early2cell"
vector_rpkm=list.files("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
name_file=rep(0,length(vector_rpkm))
for (i in 1:length(vector_rpkm)){
#name_file[i]=substr(vector_rpkm[i],1,10)
name_file[i]=read.table(vector_rpkm[i],header = T,sep="\t")[3]
}
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
data_genes=read.table(vector_rpkm[1],header = T,sep="\t")
genes_name=data_genes[,1]
deng_rpkm_oocyte=matrix(unlist(name_file), byrow=FALSE, nrow=length(name_file[[1]]))
deng_rpkm_oocyte=log(deng_rpkm_oocyte+1)
row.names(deng_rpkm_oocyte)=genes_name
colnames(deng_rpkm_oocyte)=vector_rpkm
colnames(deng_rpkm_oocyte)[grep("oo",vector_rpkm)]="oocyte"
#genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3")
genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3","Nlrp5","Myod1")
deng_all=cbind(deng_rpkm[genes_to_plot,],deng_rpkm_oocyte[genes_to_plot,])
deng_rpkm_plot=as.matrix(deng_all)
stages_deng=colnames(deng_rpkm_plot)
mean_oocyte=apply(deng_rpkm_plot[,stages_deng=="oocyte"],1,mean)
mean_zygote=apply(deng_rpkm_plot[,stages_deng=="zygote"],1,mean)
mean_early2cell=apply(deng_rpkm_plot[,stages_deng=="early2cell"],1,mean)
deng_rpkm_plot_mean=rbind(mean_oocyte,mean_zygote,mean_early2cell)
deng_rpkm_plot_mean=t(deng_rpkm_plot_mean)
library(gplots)
heatmap.2(deng_rpkm_plot_mean, scale = "none", col = bluered(100),
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F)
second_mouse=read.table("/Users/gabriele.lubatti/Downloads/GSE57249_fpkm.txt",header=TRUE)
row.names(second_mouse)=second_mouse$ID
second_mouse=second_mouse[,-1]
second_mouse=log(second_mouse+1)
meta_second=read.csv("/Users/gabriele.lubatti/Downloads/meta_second.tsv",sep="\t")
meta_info=meta_second$Title
stages=rep(0,length(meta_info))
id=rep(0,length(meta_info))
for (i in 1:length(stages)){
stages[i]=strsplit(meta_info[i],":")[[1]][2]
}
for (i in 1:length(stages)){
id[i]=strsplit(meta_info[i],":")[[1]][1]
}
id_zygote=id[grep("Zygote",stages)]
second_mouse=second_mouse[,id_zygote]
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Genome")
genome_mouse=read.table("topo.txt",sep="\t",header = T)
row.names(genome_mouse)=genome_mouse[,1]
geni_common=intersect(row.names(genome_mouse),row.names(second_mouse))
gene_name=genome_mouse[geni_common,3]
genome_mouse_small=genome_mouse[genome_mouse$Gene.name%in%genes_to_plot,]
row.names(genome_mouse_small)=genome_mouse_small$Gene.name
genome_mouse_small=genome_mouse_small[genes_to_plot,]
second_mouse_plot=second_mouse[genome_mouse_small$Gene.stable.ID,]
row.names(second_mouse_plot)=genome_mouse_small$Gene.name
plot_together=cbind(second_mouse_plot,deng_rpkm_plot)
stages_together=colnames(plot_together)
mean_oocyte=apply(plot_together[,stages_together=="oocyte"],1,mean)
mean_zygote=apply(plot_together[,stages_together=="zygote"|stages_together=="Zygote"],1,mean)
mean_early2C=apply(plot_together[,stages_together=="early2cell"],1,mean)
plot_together_mean=rbind(mean_oocyte,mean_zygote,mean_early2C)
plot_together_mean=t(plot_together_mean)
breaks = seq(0,max(plot_together_mean),length.out=1000)
gradient1 = colorpanel( sum( breaks[-1]<=7 ), "white","black")
gradient2 = colorpanel( sum( breaks[-1]>7 ), "black", "red" )
hm.colors = c(gradient1,gradient2)
#bluered(100)
library(gplots)
pdf("/Users/gabriele.lubatti/Downloads/heatmap_together_full.pdf")
heatmap.2(plot_together_mean, scale = "none", col = hm.colors,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
dev.off()
heatmap.2(plot_together_mean, scale = "none", col = hm.colors,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
plot_together_mean
deng_rpkm_oocyte["Myod1",]
deng_rpkm["Myod1",]
setwd("/Users/gabriele.lubatti/Downloads")
#annotation=read.table("/Users/gabriele.lubatti/Downloads/E-MEXP-73.sdrf.txt",header = T, sep="\t")
#annotation=read.table("/Users/gabriele.lubatti/Downloads/E-MEXP-73.raw.1/E-MEXP-73-raw-data-232125908.txt",sep="\t")
annotation=read.csv("/Users/gabriele.lubatti/Downloads/1-s2.0-S1534580703003733-mmc1.txt",sep="\t")
genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3")
#annotation$Symbol.based.on.NIA.Gene.Index..U.NAP.%in%genes_to_plot
mean_1=annotation$Mean.Unfertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation),grep("Mater",annotation$Annotation))]
mean_2=annotation$Mean.Fertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation),grep("Mater",annotation$Annotation))]
mean_3=annotation$Mean.2.cell.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation),grep("Mater",annotation$Annotation))]
mean_all=cbind(mean_1,mean_2,mean_3)
row.names(mean_all)=c("Aldh1a1","Aldh1a3","Nlrp5")
colnames(mean_all)=c("Unfertilized","Fertilized","2_cell")
breaks = seq(0,max(mean_all),length.out=1000)
gradient1 = colorpanel( sum( breaks[-1]<=7 ), "white","black")
gradient2 = colorpanel( sum( breaks[-1]>7 ), "black", "red" )
hm.colors = c(gradient1,gradient2)
library(gplots)
#pdf("/Users/gabriele.lubatti/Downloads/")
heatmap.2((mean_all), scale = "none", col =hm.colors ,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
mean_1=annotation$Mean.Unfertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation))]
mean_2=annotation$Mean.Fertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation))]
mean_3=annotation$Mean.2.cell.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation))]
mean_all=cbind(mean_1,mean_2,mean_3)
row.names(mean_all)=c("Aldh1a1","Aldh1a3")
colnames(mean_all)=c("Unfertilized","Fertilized","2_cell")
breaks = seq(0,max(mean_all),length.out=1000)
gradient1 = colorpanel( sum( breaks[-1]<=7 ), "white","black")
gradient2 = colorpanel( sum( breaks[-1]>7 ), "black", "red" )
hm.colors = c(gradient1,gradient2)
library(gplots)
#pdf("/Users/gabriele.lubatti/Downloads/")
heatmap.2((mean_all), scale = "none", col =hm.colors ,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
#for folder in *.gz
#do
#gunzip ${folder}
#done
vector_rpkm=list.files("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
name_file=rep(0,length(vector_rpkm))
for (i in 1:length(vector_rpkm)){
name_file[i]=substr(vector_rpkm[i],1,10)
name_file[i]=read.table(vector_rpkm[i],header = F)[3]
}
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
data_genes=read.table(vector_rpkm[1],header = F)
genes_name=data_genes[,1]
deng_rpkm=matrix(unlist(name_file), byrow=FALSE, nrow=length(name_file[[1]]))
deng_rpkm=log(deng_rpkm+1)
row.names(deng_rpkm)=genes_name
colnames(deng_rpkm)=vector_rpkm
colnames(deng_rpkm)[grep("zy",vector_rpkm)]="zygote"
colnames(deng_rpkm)[grep("early2cell",vector_rpkm)]="early2cell"
vector_rpkm=list.files("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
name_file=rep(0,length(vector_rpkm))
for (i in 1:length(vector_rpkm)){
#name_file[i]=substr(vector_rpkm[i],1,10)
name_file[i]=read.table(vector_rpkm[i],header = T,sep="\t")[3]
}
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
data_genes=read.table(vector_rpkm[1],header = T,sep="\t")
genes_name=data_genes[,1]
deng_rpkm_oocyte=matrix(unlist(name_file), byrow=FALSE, nrow=length(name_file[[1]]))
deng_rpkm_oocyte=log(deng_rpkm_oocyte+1)
row.names(deng_rpkm_oocyte)=genes_name
colnames(deng_rpkm_oocyte)=vector_rpkm
colnames(deng_rpkm_oocyte)[grep("oo",vector_rpkm)]="oocyte"
#genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3")
genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3","Nlrp5","Myod1")
deng_all=cbind(deng_rpkm[genes_to_plot,],deng_rpkm_oocyte[genes_to_plot,])
deng_rpkm_plot=as.matrix(deng_all)
stages_deng=colnames(deng_rpkm_plot)
mean_oocyte=apply(deng_rpkm_plot[,stages_deng=="oocyte"],1,mean)
mean_zygote=apply(deng_rpkm_plot[,stages_deng=="zygote"],1,mean)
mean_early2cell=apply(deng_rpkm_plot[,stages_deng=="early2cell"],1,mean)
deng_rpkm_plot_mean=rbind(mean_oocyte,mean_zygote,mean_early2cell)
deng_rpkm_plot_mean=t(deng_rpkm_plot_mean)
library(gplots)
heatmap.2(deng_rpkm_plot_mean, scale = "none", col = bluered(100),
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F)
#for folder in *.gz
#do
#gunzip ${folder}
#done
vector_rpkm=list.files("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
name_file=rep(0,length(vector_rpkm))
for (i in 1:length(vector_rpkm)){
name_file[i]=substr(vector_rpkm[i],1,10)
name_file[i]=read.table(vector_rpkm[i],header = F)[3]
}
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
data_genes=read.table(vector_rpkm[1],header = F)
genes_name=data_genes[,1]
deng_rpkm=matrix(unlist(name_file), byrow=FALSE, nrow=length(name_file[[1]]))
deng_rpkm=log(deng_rpkm+1)
row.names(deng_rpkm)=genes_name
colnames(deng_rpkm)=vector_rpkm
colnames(deng_rpkm)[grep("zy",vector_rpkm)]="zygote"
colnames(deng_rpkm)[grep("early2cell",vector_rpkm)]="early2cell"
vector_rpkm=list.files("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
name_file=rep(0,length(vector_rpkm))
for (i in 1:length(vector_rpkm)){
#name_file[i]=substr(vector_rpkm[i],1,10)
name_file[i]=read.table(vector_rpkm[i],header = T,sep="\t")[3]
}
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
data_genes=read.table(vector_rpkm[1],header = T,sep="\t")
genes_name=data_genes[,1]
deng_rpkm_oocyte=matrix(unlist(name_file), byrow=FALSE, nrow=length(name_file[[1]]))
deng_rpkm_oocyte=log(deng_rpkm_oocyte+1)
row.names(deng_rpkm_oocyte)=genes_name
colnames(deng_rpkm_oocyte)=vector_rpkm
colnames(deng_rpkm_oocyte)[grep("oo",vector_rpkm)]="oocyte"
#genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3")
genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3","Nlrp5")
deng_all=cbind(deng_rpkm[genes_to_plot,],deng_rpkm_oocyte[genes_to_plot,])
deng_rpkm_plot=as.matrix(deng_all)
stages_deng=colnames(deng_rpkm_plot)
mean_oocyte=apply(deng_rpkm_plot[,stages_deng=="oocyte"],1,mean)
mean_zygote=apply(deng_rpkm_plot[,stages_deng=="zygote"],1,mean)
mean_early2cell=apply(deng_rpkm_plot[,stages_deng=="early2cell"],1,mean)
deng_rpkm_plot_mean=rbind(mean_oocyte,mean_zygote,mean_early2cell)
deng_rpkm_plot_mean=t(deng_rpkm_plot_mean)
library(gplots)
heatmap.2(deng_rpkm_plot_mean, scale = "none", col = bluered(100),
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F)
second_mouse=read.table("/Users/gabriele.lubatti/Downloads/GSE57249_fpkm.txt",header=TRUE)
row.names(second_mouse)=second_mouse$ID
second_mouse=second_mouse[,-1]
second_mouse=log(second_mouse+1)
meta_second=read.csv("/Users/gabriele.lubatti/Downloads/meta_second.tsv",sep="\t")
meta_info=meta_second$Title
stages=rep(0,length(meta_info))
id=rep(0,length(meta_info))
for (i in 1:length(stages)){
stages[i]=strsplit(meta_info[i],":")[[1]][2]
}
for (i in 1:length(stages)){
id[i]=strsplit(meta_info[i],":")[[1]][1]
}
id_zygote=id[grep("Zygote",stages)]
second_mouse=second_mouse[,id_zygote]
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Genome")
genome_mouse=read.table("topo.txt",sep="\t",header = T)
row.names(genome_mouse)=genome_mouse[,1]
geni_common=intersect(row.names(genome_mouse),row.names(second_mouse))
gene_name=genome_mouse[geni_common,3]
genome_mouse_small=genome_mouse[genome_mouse$Gene.name%in%genes_to_plot,]
row.names(genome_mouse_small)=genome_mouse_small$Gene.name
genome_mouse_small=genome_mouse_small[genes_to_plot,]
second_mouse_plot=second_mouse[genome_mouse_small$Gene.stable.ID,]
row.names(second_mouse_plot)=genome_mouse_small$Gene.name
plot_together=cbind(second_mouse_plot,deng_rpkm_plot)
stages_together=colnames(plot_together)
mean_oocyte=apply(plot_together[,stages_together=="oocyte"],1,mean)
mean_zygote=apply(plot_together[,stages_together=="zygote"|stages_together=="Zygote"],1,mean)
mean_early2C=apply(plot_together[,stages_together=="early2cell"],1,mean)
plot_together_mean=rbind(mean_oocyte,mean_zygote,mean_early2C)
plot_together_mean=t(plot_together_mean)
breaks = seq(0,max(plot_together_mean),length.out=1000)
gradient1 = colorpanel( sum( breaks[-1]<=7 ), "white","black")
gradient2 = colorpanel( sum( breaks[-1]>7 ), "black", "red" )
hm.colors = c(gradient1,gradient2)
#bluered(100)
library(gplots)
pdf("/Users/gabriele.lubatti/Downloads/heatmap_together_full.pdf")
heatmap.2(plot_together_mean, scale = "none", col = hm.colors,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
dev.off()
heatmap.2(plot_together_mean, scale = "none", col = hm.colors,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
library(CIARA)
load(system.file("extdata", "raw_elmir_5_30.Rda", package ="CIARA"))
umap_elmir=readRDS(system.file("extdata", "annot_umap.rds", package ="CIARA"))
setwd("/Users/gabriele.lubatti/Desktop/Phd/entropy_of_mixing_library/elmir_data")
write.csv(umap_elmir,"umap_elmir.csv")
load(system.file("extdata", "elmir_december_2021.Rda", package ="CIARA"))
load("/Users/gabriele.lubatti/Desktop/Phd/entropy_of_mixing_library/github_january_2022/elmir_december_2021.Rda")
head(result)
marco_all=read.csv("/Users/gabriele.lubatti/Downloads/Human_gastrula_full.csv")
dim(marco_all)
head(marco_all)
marco_all=read.csv("/Users/gabriele.lubatti/Downloads/Human_gastrula_full.csv")
row.names(marco_all)=marco_all$X
marco_all=marco_all[marco_all$CIARA_background=="True",]
head(result)
row.names(result)
row.names(result)[1:10]
marco_all=marco_all[row.names(result),]
bac_marco=marco_all$CIARA_background
p_marco=marco_all$CIARA_p_value
length(bac_marco)
length(row.names(result))
all(bac_marco==row.names(result))
sum(bac_marco==row.names(result))
bac_marco
sum(row.names(marco_all)==row.names(result))
all(row.names(marco_all)==row.names(result))
all(result[,1]==p_marco)
sum(result[,1]==p_marco)
p_marco
which(!result[,1]==p_marco)
which(!result[,1]==p_marco)[1:10]
result[,1][1]
p_marco[,1]
p_marco[1]
2.486022e-07==2.486022e-07
result[,1][1]
result[,1][1]==p_marco[1]
p_marco[1]
result[,1][1]
result[,1][1]==p_marco[1]
as.vector(result[,1][1])==p_marco[1]
s.vector(result[,1][1])
as.vector(result[,1][1])
p_marco[1]
as.vector(result[,1][1])==p_marco[1]
round(as.vector(result[,1][1]),10)==round(p_marco[1],10)
round(as.vector(result[,1][1]),20)==round(p_marco[1],20)
round(as.vector(result[,1][1]),15)==round(p_marco[1],15)
round(as.vector(result[,1][1]),16)==round(p_marco[1],15)
round(as.vector(result[,1][1]),16)==round(p_marco[1],16)
round(as.vector(result[,1][1]),17)==round(p_marco[1],17)
round(as.vector(result[,1][1]),18)==round(p_marco[1],18)
round(as.vector(result[,1][1]),19)==round(p_marco[1],18)
round(as.vector(result[,1][1]),19)==round(p_marco[1],19)
round(as.vector(result[,1][1]),20)==round(p_marco[1],20)
identical(p_marco,as.vector(result[,1]))
identical(p_marco,as.vector(result[,1]))
as.vector(result[,1]
)
p_marco
all.equal(as.vector(result[,1]),p_marco)
?all.equal
all.equal(as.vector(result[,1]),p_marco,tolerance = 1.5e-16)
all.equal(as.vector(result[,1]),p_marco,tolerance = 1.5e-15)
all.equal(as.vector(result[,1]),p_marco,tolerance = 1e-15)
all.equal(as.vector(result[,1]),p_marco,tolerance = 1e-10)
all.equal(as.vector(result[,1]),p_marco,tolerance = 1e-11)
all.equal(as.vector(result[,1]),p_marco,tolerance = 1e-12)
all.equal(as.vector(result[,1]),p_marco,tolerance = 1e-13)
sort(result[,1][1])
sort(result[,1][2])
sort(result[,1])[1]
sort(result[,1])[10]
#for folder in *.gz
#do
#gunzip ${folder}
#done
vector_rpkm=list.files("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
name_file=rep(0,length(vector_rpkm))
for (i in 1:length(vector_rpkm)){
name_file[i]=substr(vector_rpkm[i],1,10)
name_file[i]=read.table(vector_rpkm[i],header = F)[3]
}
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_RPKM")
data_genes=read.table(vector_rpkm[1],header = F)
genes_name=data_genes[,1]
deng_rpkm=matrix(unlist(name_file), byrow=FALSE, nrow=length(name_file[[1]]))
deng_rpkm=log(deng_rpkm+1)
row.names(deng_rpkm)=genes_name
colnames(deng_rpkm)=vector_rpkm
colnames(deng_rpkm)[grep("zy",vector_rpkm)]="zygote"
colnames(deng_rpkm)[grep("early2cell",vector_rpkm)]="early2cell"
vector_rpkm=list.files("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
name_file=rep(0,length(vector_rpkm))
for (i in 1:length(vector_rpkm)){
#name_file[i]=substr(vector_rpkm[i],1,10)
name_file[i]=read.table(vector_rpkm[i],header = T,sep="\t")[3]
}
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Mouse_published_dataset/Deng_oocyte")
data_genes=read.table(vector_rpkm[1],header = T,sep="\t")
genes_name=data_genes[,1]
deng_rpkm_oocyte=matrix(unlist(name_file), byrow=FALSE, nrow=length(name_file[[1]]))
deng_rpkm_oocyte=log(deng_rpkm_oocyte+1)
row.names(deng_rpkm_oocyte)=genes_name
colnames(deng_rpkm_oocyte)=vector_rpkm
colnames(deng_rpkm_oocyte)[grep("oo",vector_rpkm)]="oocyte"
#genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3")
genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3","Nlrp5","Myod1")
deng_all=cbind(deng_rpkm[genes_to_plot,],deng_rpkm_oocyte[genes_to_plot,])
deng_rpkm_plot=as.matrix(deng_all)
stages_deng=colnames(deng_rpkm_plot)
mean_oocyte=apply(deng_rpkm_plot[,stages_deng=="oocyte"],1,mean)
mean_zygote=apply(deng_rpkm_plot[,stages_deng=="zygote"],1,mean)
mean_early2cell=apply(deng_rpkm_plot[,stages_deng=="early2cell"],1,mean)
deng_rpkm_plot_mean=rbind(mean_oocyte,mean_zygote,mean_early2cell)
deng_rpkm_plot_mean=t(deng_rpkm_plot_mean)
library(gplots)
heatmap.2(deng_rpkm_plot_mean, scale = "none", col = bluered(100),
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F)
second_mouse=read.table("/Users/gabriele.lubatti/Downloads/GSE57249_fpkm.txt",header=TRUE)
row.names(second_mouse)=second_mouse$ID
second_mouse=second_mouse[,-1]
second_mouse=log(second_mouse+1)
meta_second=read.csv("/Users/gabriele.lubatti/Downloads/meta_second.tsv",sep="\t")
meta_info=meta_second$Title
stages=rep(0,length(meta_info))
id=rep(0,length(meta_info))
for (i in 1:length(stages)){
stages[i]=strsplit(meta_info[i],":")[[1]][2]
}
for (i in 1:length(stages)){
id[i]=strsplit(meta_info[i],":")[[1]][1]
}
id_zygote=id[grep("Zygote",stages)]
second_mouse=second_mouse[,id_zygote]
setwd("/Users/gabriele.lubatti/Desktop/Phd/Early_embryonic_like_cells/Mouse/Genome")
genome_mouse=read.table("topo.txt",sep="\t",header = T)
row.names(genome_mouse)=genome_mouse[,1]
geni_common=intersect(row.names(genome_mouse),row.names(second_mouse))
gene_name=genome_mouse[geni_common,3]
genome_mouse_small=genome_mouse[genome_mouse$Gene.name%in%genes_to_plot,]
row.names(genome_mouse_small)=genome_mouse_small$Gene.name
genome_mouse_small=genome_mouse_small[genes_to_plot,]
second_mouse_plot=second_mouse[genome_mouse_small$Gene.stable.ID,]
row.names(second_mouse_plot)=genome_mouse_small$Gene.name
plot_together=cbind(second_mouse_plot,deng_rpkm_plot)
stages_together=colnames(plot_together)
mean_oocyte=apply(plot_together[,stages_together=="oocyte"],1,mean)
mean_zygote=apply(plot_together[,stages_together=="zygote"|stages_together=="Zygote"],1,mean)
mean_early2C=apply(plot_together[,stages_together=="early2cell"],1,mean)
plot_together_mean=rbind(mean_oocyte,mean_zygote,mean_early2C)
plot_together_mean=t(plot_together_mean)
breaks = seq(0,max(plot_together_mean),length.out=1000)
gradient1 = colorpanel( sum( breaks[-1]<=7 ), "white","black")
gradient2 = colorpanel( sum( breaks[-1]>7 ), "black", "red" )
hm.colors = c(gradient1,gradient2)
#bluered(100)
library(gplots)
pdf("/Users/gabriele.lubatti/Downloads/heatmap_together_full.pdf")
heatmap.2(plot_together_mean, scale = "none", col = hm.colors,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
dev.off()
heatmap.2(plot_together_mean, scale = "none", col = hm.colors,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
setwd("/Users/gabriele.lubatti/Downloads")
#annotation=read.table("/Users/gabriele.lubatti/Downloads/E-MEXP-73.sdrf.txt",header = T, sep="\t")
#annotation=read.table("/Users/gabriele.lubatti/Downloads/E-MEXP-73.raw.1/E-MEXP-73-raw-data-232125908.txt",sep="\t")
annotation=read.csv("/Users/gabriele.lubatti/Downloads/1-s2.0-S1534580703003733-mmc1.txt",sep="\t")
genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3")
#annotation$Symbol.based.on.NIA.Gene.Index..U.NAP.%in%genes_to_plot
mean_1=annotation$Mean.Unfertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation),grep("Mater",annotation$Annotation),grep("Myod1",annotation$Annotation))]
mean_2=annotation$Mean.Fertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation),grep("Mater",annotation$Annotation),grep("Myod1",annotation$Annotation))]
mean_3=annotation$Mean.2.cell.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation),grep("Mater",annotation$Annotation),grep("Myod1",annotation$Annotation))]
mean_all=cbind(mean_1,mean_2,mean_3)
row.names(mean_all)=c("Aldh1a1","Aldh1a3","Nlrp5")
setwd("/Users/gabriele.lubatti/Downloads")
#annotation=read.table("/Users/gabriele.lubatti/Downloads/E-MEXP-73.sdrf.txt",header = T, sep="\t")
#annotation=read.table("/Users/gabriele.lubatti/Downloads/E-MEXP-73.raw.1/E-MEXP-73-raw-data-232125908.txt",sep="\t")
annotation=read.csv("/Users/gabriele.lubatti/Downloads/1-s2.0-S1534580703003733-mmc1.txt",sep="\t")
genes_to_plot=c("Rdh10","Aldh1a1","Aldh1a2","Aldh1a3")
#annotation$Symbol.based.on.NIA.Gene.Index..U.NAP.%in%genes_to_plot
mean_1=annotation$Mean.Unfertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation),grep("Mater",annotation$Annotation),grep("Myod1",annotation$Annotation))]
mean_2=annotation$Mean.Fertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation),grep("Mater",annotation$Annotation),grep("Myod1",annotation$Annotation))]
mean_3=annotation$Mean.2.cell.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation),grep("Mater",annotation$Annotation),grep("Myod1",annotation$Annotation))]
mean_all=cbind(mean_1,mean_2,mean_3)
row.names(mean_all)=c("Aldh1a1","Aldh1a3","Nlrp5","Myod1")
colnames(mean_all)=c("Unfertilized","Fertilized","2_cell")
breaks = seq(0,max(mean_all),length.out=1000)
gradient1 = colorpanel( sum( breaks[-1]<=7 ), "white","black")
gradient2 = colorpanel( sum( breaks[-1]>7 ), "black", "red" )
hm.colors = c(gradient1,gradient2)
library(gplots)
#pdf("/Users/gabriele.lubatti/Downloads/")
heatmap.2((mean_all), scale = "none", col =hm.colors ,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
mean_1=annotation$Mean.Unfertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation))]
mean_2=annotation$Mean.Fertilized.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation))]
mean_3=annotation$Mean.2.cell.[c(grep("Aldh1a1",annotation$Annotation),grep("Aldh1a3",annotation$Annotation))]
mean_all=cbind(mean_1,mean_2,mean_3)
row.names(mean_all)=c("Aldh1a1","Aldh1a3")
colnames(mean_all)=c("Unfertilized","Fertilized","2_cell")
breaks = seq(0,max(mean_all),length.out=1000)
gradient1 = colorpanel( sum( breaks[-1]<=7 ), "white","black")
gradient2 = colorpanel( sum( breaks[-1]>7 ), "black", "red" )
hm.colors = c(gradient1,gradient2)
library(gplots)
#pdf("/Users/gabriele.lubatti/Downloads/")
heatmap.2((mean_all), scale = "none", col =hm.colors ,
trace = "none", density.info = "none",cexRow = 0.7,cexCol = 0.7,notecex=2,notecol="black",Rowv=F,Colv=F,breaks = breaks)
